let courseDetails = {
    courseDetails: [
        {
            code: "GN1101",
            Name: "Life Skills 1",
            type: "Science",
            credits: "0",
            grade: "",
            attendance: "VG"
        },
        {
            code: "ID1200",
            Name: "Ecology and Environment",
            type: "Science",
            credits: "0",
            grade: "",
            attendance: "VG"
        },
        {
            code: "MA1101",
            Name: "Functions of Several Variables",
            type: "Science",
            credits: "10",
            grade: "",
            attendance: "VG"
        },
        {
            code: "ME1480",
            Name: "Engineering Drawing",
            type: "Engineering",
            credits: "7",
            grade: "",
            attendance: "G"
        },
        {
            code: "PH1010",
            Name: "Physics I",
            type: "Science",
            credits: "10",
            grade: "",
            attendance: "VG"
        },
        {
            code: "AM1100A",
            Name: "Engineering Mechanics",
            type: "Engineering",
            credits: "10",
            grade: "",
            attendance: "G"
        },
        {
            code: "CE1010",
            Name: "Introduction to Civil Engineering Profession",
            type: "Professional",
            credits: "8",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE2330",
            Name: "Civil Engineering Materials and Construction",
            type: "Professional",
            credits: "9",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CS1100",
            Name: "Introduction to Programming",
            type: "Engineering",
            credits: "12",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CY1001#",
            Name: "Chemistry I: Structure, Bonding & Reactivity",
            type: "Science",
            credits: "10",
            grade: "",
            attendance: "VG"
        },
        {
            code: "GN1102",
            Name: "Life Skills 2",
            type: "Science",
            credits: "0",
            grade: "",
            attendance: "VG"
        },
        {
            code: "PH1020",
            Name: "Physics II",
            type: "Science",
            credits: "10",
            grade: "",
            attendance: "G"
        },
        {
            code: "PH1030",
            Name: "Physics Laboratory I",
            type: "Science",
            credits: "4",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CY1002",
            Name: "Chemistry Lab I",
            type: "Science",
            credits: "3",
            grade: "",
            attendance: "VG"
        },
        {
            code: "MA1102",
            Name: "Series and Matrices",
            type: "Science",
            credits: "10",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE2040",
            Name: "Hydraulic Engineering",
            type: "Professional",
            credits: "11",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE2080",
            Name: "Surveying",
            type: "Professional",
            credits: "10",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE2310",
            Name: "Mechanics of materials",
            type: "Engineering",
            credits: "11",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE3015",
            Name: "Highway Engineering",
            type: "Professional",
            credits: "9",
            grade: "",
            attendance: "VG"
        },
        {
            code: "MA2040",
            Name: "Probability, Statistics and Stochastic Process",
            type: "Science",
            credits: "9",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE2020",
            Name: "Structural Analysis",
            type: "Professional",
            credits: "11",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE3060",
            Name: "Geotechnical Engineering I",
            type: "Professional",
            credits: "11",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE3025",
            Name: "Traffic Engineering ",
            type: "Professional",
            credits: "9",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE3040",
            Name: "Environmental Engineering",
            type: "Professional",
            credits: "10",
            grade: "",
            attendance: "VG"
        },
        {
            code: "HS4570",
            Name: "Introduction to Chinese Language",
            type: "Humanities",
            credits: "9",
            grade: "",
            attendance: "VG"
        },
        {
            code: "MA2020",
            Name: "Differential Equations",
            type: "Science",
            credits: "9",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE3060",
            Name: "Basic design of reinforced concrete structures",
            type: "Professional",
            credits: "11",
            grade: "",
            attendance: "VG"
        },
        {
            code: "HS4570",
            Name: "Urbanization and Development",
            type: "Humanities",
            credits: "10",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE4500",
            Name: "Hydraulic and Environmental Engineering Lab",
            type: "Professional",
            credits: "4",
            grade: "",
            attendance: "VG"
        },
        {
            code: "BT1010",
            Name: "Life Sciences",
            type: "Science",
            credits: "9",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE3030",
            Name: "Water Resources Engineering",
            type: "Professional",
            credits: "12",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE3350",
            Name: "Geotechnical Engineering II",
            type: "Professional",
            credits: "11",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE3410",
            Name: "Construction Materials Laboratory",
            type: "Professional",
            credits: "4",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE4010",
            Name: "Construction Project Management",
            type: "Professional",
            credits: "10",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE3050",
            Name: "Basic Steel Design",
            type: "Professional",
            credits: "11",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE3100",
            Name: "Structural engineering laboratory",
            type: "Professional",
            credits: "4",
            grade: "",
            attendance: "VG"
        },
        {
            code: "HS3002",
            Name: "Principles of Economics",
            type: "Humanities",
            credits: "9",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE4310",
            Name: "Design of Concrete Structural Systems",
            type: "Professional",
            credits: "9",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE6051",
            Name: "Machine Learning in Civil Engineering",
            type: "Professional",
            credits: "9",
            grade: "",
            attendance: "VG"
        },
        {
            code: "CE6018",
            Name: "Seismic Data Analytics",
            type: "Professional",
            credits: "9",
            grade: "",
            attendance: "VG"
        }
    ]
};

let gradeDetails = {
    S: 10,
    A: 9,
    B: 8,
    C: 7,
    D: 6,
    E: 4,
    F: 0,
    U: 0,
    P: 0
};

// Function to generate input fields based on the number of courses
function generateCourseInputs() {
    const totalCourses = document.getElementById('total-courses').value;
    const courseInputsDiv = document.getElementById('course-inputs');
    courseInputsDiv.innerHTML = ''; // Clear previous inputs

    for (let i = 0; i < totalCourses; i++) {
        const courseDiv = document.createElement('div');
        courseDiv.className = 'course';

        const courseLabel = document.createElement('label');
        courseLabel.textContent = `Course ${i + 1} Code:`;
        const courseSelect = document.createElement('select');
        courseSelect.className = 'course-code';

        const defaultOption = document.createElement('option');
        defaultOption.value = '';
        defaultOption.textContent = 'Select Course';
        courseSelect.appendChild(defaultOption);

        // Populate course options
        courseDetails.courseDetails.forEach(course => {
            const option = document.createElement('option');
            option.value = course.code;
            option.textContent = `${course.code} - ${course.Name}`;
            courseSelect.appendChild(option);
        });

        const gradeLabel = document.createElement('label');
        gradeLabel.textContent = 'Grade:';
        const gradeSelect = document.createElement('select');
        gradeSelect.className = 'grade';
        gradeSelect.innerHTML = `
            <option value="">Select Grade</option>
            <option value="S">S</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
            <option value="E">E</option>
            <option value="F">F</option>
            <option value="U">U</option>
            <option value="P">P</option>
        `;

        courseDiv.appendChild(courseLabel);
        courseDiv.appendChild(courseSelect);
        courseDiv.appendChild(gradeLabel);
        courseDiv.appendChild(gradeSelect);
        courseInputsDiv.appendChild(courseDiv);
    }

    document.getElementById('calculate-button').style.display = 'block';
}

// Function to calculate CGPA
function calculateCGPA() {
    const courseCodes = document.querySelectorAll('.course-code');
    const gradeSelects = document.querySelectorAll('.grade');
    let totalWeightedCredits = 0;
    let totalCredits = 0;

    for (let i = 0; i < courseCodes.length; i++) {
        const courseCode = courseCodes[i].value.toUpperCase();
        const grade = gradeSelects[i].value.toUpperCase();

        // Find the course details by code
        const courseDetail = courseDetails.courseDetails.find(course => course.code === courseCode);

        if (courseDetail) {
            const creditValue = parseInt(courseDetail.credits, 10);
            if (gradeDetails.hasOwnProperty(grade)) {
                const gradeValue = gradeDetails[grade];
                totalWeightedCredits += creditValue * gradeValue;
                totalCredits += creditValue;
            } else {
                alert(`Invalid grade entered: ${grade}. Please select a valid grade.`);
                return;
            }
        } else {
            alert(`Course code ${courseCode} is not found in the data sheet.`);
            return;
        }
    }

    const cgpa = totalWeightedCredits / totalCredits;
    document.getElementById('cgpa-result').textContent = `Your CGPA is: ${cgpa.toFixed(2)}`;
}
